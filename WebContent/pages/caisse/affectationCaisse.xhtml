<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//FR" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  V 0.1 : Maj : 09/11/2007 -->

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:a="https://ajax4jsf.dev.java.net/ajax"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/template/template.xhtml">
	<!-- Page d'accueil -->





	<ui:define name="title">GESTION  #{msgBundle['gestock.titre.affectationCaisse']} </ui:define>
	<ui:define name="body">
		<h:form id="note">

			
			<div class="zoneResultat2" style="height:600px;overflow: auto"  >
			
			<table> <tr> 
			      <td> <s:graphicImage fileName="candidat_64.png" style="border:0px;" value="/picto/candidat_64.png" width="40" height="40" alt="Peupler" /> </td> 
			        <td> <h1>  #{msgBundle['gestock.titre.affectationCaisse']}    </h1>  </td> 
			      </tr>    
			</table>					 
			
			
			
			<rich:panel header="  #{msgBundle['gestock.titre.affectationCaisse']} ">
			
			<fieldset>
			<legend> size:  #{dispatchingCaisseService.listeCaisse.size()}  #{msgBundle['gestock.listeCaisse']} </legend>
			<div style="height:400px;overflow: auto">
			<rich:dataTable value="#{dispatchingCaisseService.listeCaisse}" var="it"
							id="liste" style="width:100%;" rowClasses="row1,row2">
							<f:facet name="header">
								<rich:columnGroup>
									<rich:column>
										<h:outputLabel value="Libelle  "
											style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
									</rich:column>
									<rich:column>
										<h:outputLabel value="Code  "
											style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
									</rich:column>
									
										<rich:column>
										<h:outputLabel value="Principale   "
											style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
									</rich:column>
									
									
									<rich:column>
										<h:outputLabel value="Caissier"
											style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
									</rich:column>
									
									<rich:column>
										<h:outputLabel value="Actions"
											style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
									</rich:column>
								</rich:columnGroup>
							</f:facet>

							
							<rich:column >
								<h:outputText value="#{it.libelle}" styleClass="grey" />
							</rich:column>
							<rich:column >
								<h:outputText value="#{it.libelle_court}" styleClass="grey" />
							</rich:column>
							<rich:column >
							      <TABLE align="center" >  <tr >  <td align="center" >
								<h:outputText value="Oui" rendered="#{it.caissePrincipalON}" styleClass="grey" />
								<h:outputText value="Non" rendered="#{not it.caissePrincipalON}" styleClass="grey" />
								</td> </tr></TABLE>
							</rich:column>
							
							<rich:column >
								<h:outputText value="#{it.userCaissier}" styleClass="grey" />
							</rich:column>
							 
							<rich:column width="100px">

								<table width="100%"  >
									<tr>
									   
									 <td align="center" >
											  <a:commandLink immediate="true" status="waitStatus"  
												action="#{dispatchingCaisseService.initAffectation(it)}" value="" title="CHOISIR LE CAISSIER "
												reRender="idFormPanel" styleClass="lienSansSoulignement"
												oncomplete="javascript:Richfaces.showModalPanel('panel',{width:500, top:5, height:500});jQuery('#ModificationPassword\\:prenomEnfant').focus();">
												<s:graphicImage fileName="candidat_64.png" style="border:0px;" value="/picto/candidat_64.png" width="16" height="16" alt="" />
											 </a:commandLink>
									</td>
											
										 
									</tr>
								</table>

							</rich:column>

						</rich:dataTable>
				 </div>	
			</fieldset>
			
			
		
		   </rich:panel>
       </div>			
		</h:form>
		
		
		<rich:modalPanel id="panel" style="background:url('../img2/fond.jpg') repeat-x scroll 0 0 #FFF;height:590; " >
			<div class="cadreBordOrange margTop30px padLeft30px padRight30px"  >
			<div class="zoneTitreOrange margTop10px padLeft10px">
			   #{msgBundle['gestock.titre.affectationCaisse']}  
			</div>
			<br />
			<div class="margtop30px">
			<f:facet name="controls">
				<a onclick="Richfaces.hideModalPanel('panel');" style="cursor:pointer" href="#">#{msgBundle['label.fermer']}</a>
			</f:facet>


			<div ><!-- Holds the form -->
			
			<h:form class="note-form" id="idFormPanel">
				<a:outputPanel ajaxRendered="true">
					<h:message id="erreur" infoClass="confirmationerror" errorClass="confirmationerror" warnClass="confirmationerror" for="passwordErreur"    />
        			<h:inputHidden id="passwordErreur" value="" />
        			<div style="visibility: hidden;display: none;" >
						<h:messages id="error2"></h:messages>
					</div>
				</a:outputPanel>
			<script>
				jQuery(document).ready(function()
				{
					dateEtHeureInputs();
				});

				function ajaxRequestContainsErrors() {
					var retour = jQuery("#idDetailt\\:erreur").text();
					var retour2 = jQuery("#idDetailt\\:error2").text();
					var resultat =  retour != '' || retour2 != "";
					return resultat;
				}

				function fermerSiOk()
				{
					if (!ajaxRequestContainsErrors()) Richfaces.hideModalPanel('panel');
				}
				
			</script>
			   	<table width="100%">
			   	     <tr>
							    <td ><h:outputText value="#{msgBundle['gestock.caisse.libelle']}  :" styleClass="grey"   /> </td>
							    <td> <h:outputText  value="#{dispatchingCaisseService.caisseSecondaire.libelle}" style="color:blue ;font-weight: bold;"   />  </td>
					 </tr>
					 <tr>
							    <td ><h:outputText value="#{msgBundle['gestock.caisse.code']}  :" styleClass="grey"   /> </td>
							    <td> <h:outputText  value="#{dispatchingCaisseService.caisseSecondaire.libelle_court}" style="color:blue ;font-weight: bold;"   />  </td>
					 </tr>
					  <tr>
							    <td ><h:outputText value="#{msgBundle['gestock.utlisateurEncours']}  :" styleClass="grey"   /> </td>
							    <td> <h:outputText  value="#{dispatchingCaisseService.caisseSecondaire.userCaissier}" style="color:blue ;font-weight: bold;"   />  </td>
					 </tr>
					  <tr>
							   <td ><h:outputText value="#{msgBundle['gestock.utlisateurNouveau']}  :" styleClass="grey"   /> </td>
							 <td>
							      <h:selectOneMenu  value="#{dispatchingCaisseService.historiqueCaisseUser.utilisateur}" disabled="false" styleClass="textBleu2"  id="dis" requiredMessage="Selectionnez...." converter="#{utilisateurConverter}"  >
								     <s:selectItems  value="#{dispatchingCaisseService.listeCaissier}" noSelectionLabel="Selectionnez...."  var="it" label="#{it}" />
								</h:selectOneMenu> 
						  </td>
					 </tr>
					 
					 <tr>
								<td colspan="2" align="center">
									<br />
									<hr class="orange"/>
									<a:commandButton value="Valider" onclick="Richfaces.hideModalPanel('panel');" style="text-align:right;"  status="waitStatus" 
										action="#{dispatchingCaisseService.validerAffectation}" reRender="liste" image="/img2/bouton_valider.jpg"/> 
								</td>
					</tr>
				    
				</table>
				</h:form>
			</div>
			</div>
			</div>
			</rich:modalPanel>
			
	
			
	</ui:define>
</ui:composition>