<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//FR" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  V 0.1 : Maj : 09/11/2007 -->

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:a="https://ajax4jsf.dev.java.net/ajax"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/template/template.xhtml">
	<!-- Page d'accueil -->





	<ui:define name="title">GESTION  #{msgBundle['gestock.titre.retoureProduit']} </ui:define>
	<ui:define name="body">
		<h:form id="note">

			
			<div class="zoneResultat2" style="height:600px;overflow: auto"  >
			
		  	<table> <tr> 
			      <td> <s:graphicImage fileName="candidat_64.png" style="border:0px;" value="/picto/candidat_64.png" width="5" height="5" alt="Peupler" /> </td> 
			        <td> <h1>  #{msgBundle['gestock.titre.retoureProduit']}    </h1>  </td> 
			      </tr>    
			</table>			 
			
			
			
			<rich:panel header="  ">
			
		
			
		   <fieldset>
			<legend> </legend>
			
			
			<table width="100%" >
			  <tr>  
			    <td valign="top" width="45%">
			       <fieldset>
			       
						<legend> #{msgBundle['gestock.infocaisseEmetteur']}   </legend>
						<table align="center">
						  <tr>
								    <td> <h:outputLabel  styleClass="grey" value="#{msgBundle['gestock.caisse']} :" /> </td>
								    <td>
								    	 <h:selectOneMenu   disabled="#{dispatchingCaisseService.passation.getListeDtPassation().size()!=0}" valueChangeListener="#{dispatchingCaisseService.recuperCaisseSeconde}"   styleClass="textBleu2"  id="caisse2" requiredMessage="Selectionnez...." converter="#{caisseConverter}"  >
										     <s:selectItems  value="#{dispatchingCaisseService.listeCaisse}" var="it" label="#{it.libelle}" />
											 <a:support  event="onchange"  ajaxSingle="true" reRender="listeCaisseSecond" />	
										 </h:selectOneMenu>  
								     </td>
						 </tr>
						</table>
						
						  <div style="height:300px;overflow: auto">
						 	<rich:dataTable value="#{dispatchingCaisseService.caisseSecondaire.getListeStock()}" var="it"
								id="listeCaisseSecond" style="width:100%;" rowClasses="row1,row2">
								<f:facet name="header">
									<rich:columnGroup>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.operateur']}  " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.produit']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.quantite']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.choix']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
									</rich:columnGroup>
								</f:facet>
									<rich:column filterEvent="onkeyup" filterBy="#{it.operateur.intitule}" >
										<h:outputText value="#{it.operateur.intitule}" styleClass="grey" />
								    </rich:column>
								    <rich:column   filterEvent="onkeyup" filterBy="#{it.produit.libelle}" >
										<h:outputText value="#{it.produit.libelle}" styleClass="grey" />
								    </rich:column>
								     <rich:column >
								         <TABLE align="center" >  <tr >  <td align="center" >
										    <h:outputText value="#{it.quantite}" styleClass="grey" />
									     </td>  </tr> </TABLE>
									     
								    </rich:column>
								    <rich:column >
								        <TABLE align="right" >  <tr >  <td align="right" >
									    <a:commandLink immediate="true" status="waitStatus"  
														action="#{dispatchingCaisseService.choixStock(it,false)}" value="" title="Voir Details "
														reRender="idFormSaisi" styleClass="lienSansSoulignement"
														oncomplete="javascript:Richfaces.showModalPanel('panelSaisi',{width:400, top:5, height:400});jQuery('#ModificationPassword\\:prenomEnfant').focus();">
														<s:graphicImage fileName="left32.png" style="border:0px;" value="/picto/left32.png" width="16" height="16" alt="" />
													 </a:commandLink>
									     </td>
									     </tr>
									     </TABLE>
								     </rich:column>
								    
							</rich:dataTable>
						</div>		
				   </fieldset>
				</td>
				  <td valign="top" width="10%"/>
				<td valign="top">
			       <fieldset>
						   <legend> Produits  Sélectionnés pour la #{dispatchingCaisseService.caissePrincipale.libelle}   </legend>
					<a:outputPanel id="seconde" >
					    <div  style="height:320px;overflow: auto">
						   	<rich:dataTable value="#{dispatchingCaisseService.passation.getListeDtPassation()}" var="it" rendered="#{not empty (dispatchingCaisseService.passation.getListeDtPassation())}"
								id="listSecond" style="width:100%;" rowClasses="row1,row2">
								<f:facet name="header">
									<rich:columnGroup>
									    <rich:column> 
									             <h:outputLabel value="#{msgBundle['gestock.choix']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.operateur']}  " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.produit']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.quantite']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
										<rich:column>
											<h:outputLabel value="#{msgBundle['gestock.choix']} " style="color:black;font-size:12px;font-family: Arial;text-align:center;" />
										</rich:column>
									</rich:columnGroup>
								</f:facet>
								   <rich:column >
								        <TABLE align="left" >  <tr >  <td align="left" >
									          
									     </td>
									     </tr>
									     </TABLE>
								     </rich:column>
									<rich:column filterEvent="onkeyup" filterBy="#{it.operateur.intitule}" >
										<h:outputText value="#{it.operateur.intitule}" styleClass="grey" />
								    </rich:column>
								    <rich:column   filterEvent="onkeyup" filterBy="#{it.produit.libelle}" >
										<h:outputText value="#{it.produit.libelle}" styleClass="grey" />
								    </rich:column>
								     <rich:column >
										  <TABLE align="center" >  <tr >  <td align="center" >
										    <h:outputText value="#{it.quantite}" styleClass="grey" />
									     </td>  </tr> </TABLE>
								    </rich:column>
								    <rich:column >
								        <TABLE align="right" >  <tr >  <td align="right" >
									  
									     
									        
									     </td>
									     </tr>
									     </TABLE>
								     </rich:column>
								    
							</rich:dataTable>
						</div>
					</a:outputPanel>
				   </fieldset>
				</td>
				 
				
			
			    </tr>
			      <table width="100%" >
				<tr>
					<td width="1175px;"  align="right" >
						<div id="trd_submenu" class="trd_kb">
							<ul>
								<li>
									<a:commandLink  action="#{dispatchingCaisseService.validerPassationFond}" status="waitStatus" reRender="note"  value="">
										<s:graphicImage fileName="accept.png" style="border:0px;" value="/picto/accept.png" width="16" height="16" alt="" />
										#{msgBundle['btn.valider']}
									</a:commandLink>
								</li>
								<li>
									<a:commandLink  action="#{dispatchingCaisseService.annuler}" status="waitStatus" reRender="note"  value="">
										<s:graphicImage fileName="cross.png" style="border:0px;" value="/picto/cross.png" width="16" height="16" alt="" />
										#{msgBundle['action.annuler']}
									</a:commandLink>
								</li>
							
							</ul>
						</div>
					</td>
					<td>
						&#160;
					</td>
				</tr>
			</table>
		    </table>
			    
			    
		   </fieldset>
	 
		
		 
		</rich:panel>
		</div>
		</h:form>
		
		
		<rich:modalPanel id="panelSaisi" style="background:url('../img2/fond.jpg') repeat-x scroll 0 0 #FFF;height:590; " >
			<div class="cadreBordOrange margTop30px padLeft30px padRight30px"  >
			<div class="zoneTitreOrange margTop10px padLeft10px">
			      #{msgBundle['gestock.titre.dispatching']}
			     <h:outputText style="color:#FFFFFF ;font-size: large;font-weight: bold;" rendered="#{ dispatchingCaisseService.principalVersSecondaire}"  value=" #{dispatchingCaisseService.caisseSecondaire.libelle } vers  #{dispatchingCaisseService.caissePrincipale.libelle}   " />
			
			</div>
			<br />
			<div class="margtop30px">
			<f:facet name="controls">
				<a onclick="Richfaces.hideModalPanel('panelSaisi');" style="cursor:pointer" href="#">#{msgBundle['label.fermer']}</a>
			</f:facet>


			<div ><!-- Holds the form -->
			
			<h:form class="note-form" id="idFormSaisi">
				<a:outputPanel ajaxRendered="true">
					<h:message id="erreur" infoClass="confirmationerror" errorClass="confirmationerror" warnClass="confirmationerror" for="passwordErreur"    />
        			<h:inputHidden id="passwordErreur" value="" />
        			<div style="visibility: hidden;display: none;" >
						<h:messages id="error2"></h:messages>
					</div>
				</a:outputPanel>
			<script>
				jQuery(document).ready(function()
				{
					dateEtHeureInputs();
				});

				function ajaxRequestContainsErrors() {
					var retour = jQuery("#idDetailt\\:erreur").text();
					var retour2 = jQuery("#idDetailt\\:error2").text();
					var resultat =  retour != '' || retour2 != "";
					return resultat;
				}

				function fermerSiOk()
				{
					if (!ajaxRequestContainsErrors()) Richfaces.hideModalPanel('panelSaisi');
				}
				
			</script>
			   <table width="100%">
								 
								<tr>  
								    <td > <h:outputText  value="Opérateur  :  " styleClass="grey" /> </td>
								    <td> 
										
										<h:outputText   value=" #{dispatchingCaisseService.stockEnCours.operateur.intitule} " styleClass="grey"  style="color:blue ;font-size: large;font-weight: bold;"/>
								    </td>
								 </tr>  
								 <tr>  
								     <td > <rich:spacer  height="20px" width="4px;" />   <h:outputText  value="#{msgBundle['gestock.produit']}  :  " styleClass="grey" /> </td>
								      <td > <rich:spacer  height="20px" width="4px;" />  <h:outputText  value="#{dispatchingCaisseService.stockEnCours.produit.libelle}" style="color:blue ;font-size: large;font-weight: bold;" styleClass="textBleu2" />  </td>
								</tr> 
								 <tr>  
								     <td > <rich:spacer  height="20px" width="4px;" />   <h:outputText  value="#{msgBundle['gestock.quantite']}   :  " styleClass="grey" /> </td>
								      <td > <rich:spacer  height="20px" width="4px;" />  <h:outputText  value="#{dispatchingCaisseService.stockEnCours.quantite}" style="color:blue ;font-size: large;font-weight: bold;" styleClass="textBleu2" />  </td>
								</tr> 
								<tr>
								    <td>  <rich:spacer  height="20px" width="4px;" />  <h:outputText  value="#{msgBundle['gestock.caisse']}" styleClass="grey" />  : </td>
								    <td>
								    	 <rich:spacer  height="20px" width="4px;" />  <h:outputText  value="#{dispatchingCaisseService.caissePrincipale.libelle}" style="color:blue ;font-size: large;font-weight: bold;" styleClass="textBleu2" /> 
								     </td>
								 </tr>
								 <tr>  
								     <td > <rich:spacer  height="20px" width="4px;" />   <h:outputText  value="Quantité A Transferer  :  " styleClass="grey" /> </td>
								      <td > <rich:spacer  height="20px" width="4px;" />  <h:inputText  value="#{dispatchingCaisseService.quantite}"  styleClass="textBleu2 margBot10px nbOnly " />  </td>
								</tr> 
								<tr>
								<td colspan="2" align="center">
									<br />
									<hr class="orange"/>
									<a:commandButton value="Valider" onclick="Richfaces.hideModalPanel('panelSaisi');" style="text-align:right;"  status="waitStatus" 
										action="#{dispatchingCaisseService.choisirProduit}" reRender="note" image="/img2/bouton_valider.jpg"/> 
								</td>
							    </tr>
								
								
							</table>
					</h:form>
				</div>
			</div>
			</div>
			</rich:modalPanel>
			
			
			
	</ui:define>
</ui:composition>