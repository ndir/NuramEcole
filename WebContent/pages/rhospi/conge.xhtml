<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//FR" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  V 0.1 : Maj : 09/11/2007 -->

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:a="https://ajax4jsf.dev.java.net/ajax"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/template/template.xhtml">
	<!-- Page d'accueil -->

	<ui:define name="title">RHOSPI</ui:define>
	<ui:define name="body">
		<rich:spacer height="20px;"></rich:spacer>
		<h:form id="conge">

			<div class="container" style="margin-left: 5%;">

				<div class="row">
					<div class="col-md-12">
						<div class="panel panel-success">
							<div class="panel-heading">
								<h3 class="panel-title" style="text-align: center;">  DEMANDE D’AUTORISATION D’ABSENCE
						<TABLE style="margin-left: 85%;">
					<tr>

						<td align="right" valign="top"><h:outputLabel
								value=" #{utilisateur.prenom} - #{utilisateur.nom} (#{utilisateur.profile.libelle})"
								styleClass="green"
								style="color:#008040;font-size:15px;font-family: Arial;text-align:center;" />

						</td>
						<td align="right"><h:commandButton
								action="#{identity.logout}" image="/picto/deconxion2.png"
								value="" style="width:30px ; heigth:10px" /></td>
					</tr>
				</TABLE>
									</h3>
							</div>
							  <a:outputPanel id="ayd">
				
					  </a:outputPanel>
					        <rich:spacer height="20px"></rich:spacer>
							<p align="left">

									<a:commandLink styleClass="btn btn-success" value="" 
									action="#{congeService.preparCreat}" 
												  oncomplete="javascript:Richfaces.showModalPanel('sim',{width:1000, height:500})"
										reRender="form" status="waitStatus" >
																		
																	   NOUVELLE	DEMANDE D’AUTORISATION D’ABSENCE		
																				</a:commandLink>



								</p>
								
					
					  
						<div class="form-group has-success">
								<rich:dataTable value="#{congeService.listeConge}"
									var="o" id="liste" style="width:100%;" rows="10"
									rowClasses="row1,row2">
									<f:facet name="header">
										<rich:columnGroup>

											<rich:column>
												<h:outputLabel value="Type absence"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>
											
											<rich:column>
												<h:outputLabel value="Date debut"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>

											<rich:column>
												<h:outputLabel value="Date Fin"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>
											
											
											<rich:column>
												<h:outputLabel value="Nbrs jours"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>

											<rich:column>
												<h:outputLabel value="Motif Absence"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>
											
											<rich:column>
												<h:outputLabel value="Observation"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>

											<rich:column>
												<h:outputLabel value="Validateur"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>

										    <rich:column>
												<h:outputLabel value="Statut"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>
											<rich:column>
												<h:outputLabel value="Action"
													style="color:white;font-size:12px;font-family: Arial;text-align:center;" />
											</rich:column>


										</rich:columnGroup>
									</f:facet>

									<rich:column>
										<h:outputText value="#{o.typeAbsence.libelle}" styleClass="grey" />
									</rich:column>
									<rich:column>
										<h:outputText value="#{o.dateDebut}" styleClass="grey" />
									</rich:column>
									<rich:column>
										<h:outputText value="#{o.dateFin}" styleClass="grey" />
									</rich:column>
									
									<rich:column>
										<h:outputText value="#{o.nbrJours}" styleClass="grey" />
									</rich:column>
									
									<rich:column filterBy="#{o.motifAbsence.libelle}"
										filterEvent="onkeyup" >
										<h:outputText value="#{o.motifAbsence.libelle}"
											styleClass="grey" />
									</rich:column>


									<rich:column >
										<h:outputText value="#{o.observation}"
											styleClass="grey" />
									</rich:column>
									
								    <rich:column >
										<h:outputText value="#{o.userValide.prenom} #{o.userValide.nom}" styleClass="grey" />
									</rich:column>
									
									 <rich:column filterBy="#{o.statutValid.libelle}" filterEvent="onkeyup">
										          <h:outputText value="#{o.statutValid.libelle}" styleClass="grey" />
									 </rich:column>

									


									<rich:column>
									  <table width="100px"> <tr> 
  											<td width="50px">	<a:commandLink value="" status="waitStatus" rendered="#{ (o.statutValid.libelle_court eq 'BV')}"
													action="#{congeService.preparModification(o)}"
												     oncomplete="javascript:Richfaces.showModalPanel('sim',{width:1300, height:500})"
													reRender="form" title="Modifier">
													<s:graphicImage fileName="edit.png" style="border:0px;"
														value="/picto/edit.png" width="16" height="16" alt="" />

												</a:commandLink>
										</td>
										<td width="50px">
													<a:commandLink value="" status="waitStatus"  rendered="#{ (o.statutValid.libelle_court eq 'BV')}"
													action="#{congeService.supprimer(o)}"
													onclick="if (!confirm(' Voulez-vous vraiment supprimer cette demande  ?')) return false"
													reRender="form" title="Modifier">
													<s:graphicImage fileName="cross.png" style="border:0px;"
														value="/picto/cross.png" width="16" height="16" alt="" />

												</a:commandLink>
										  </td>
										  </tr>
										  </table>
									</rich:column>

								</rich:dataTable>
								<rich:datascroller status="waitStatus" stepControls="auto"
									style="width:100%" for="liste"
									rendered="#{not empty congeService.listeConge}" />







							</div>
					  
							
								<div class="panel-body">
									<div class="form-group has-success">
										
									</div>

								</div>
							
						</div>
					</div>
				</div>


			</div>


		</h:form>



<rich:modalPanel id="sim"
			style="background:url('../img2/fond.jpg') repeat-x scroll 0 0 #FFF;height:300; width:900"
			moveable="true" styleClass="popupAttente">
			<f:facet name="controls">

			
			</f:facet>
			<f:facet name="header">
				DEMANDE D’AUTORISATION D’ABSENCE	POUR (#{ congeService.personnel.prenom} #{congeService.personnel.nom} )
			</f:facet>
			<rich:spacer height="10px" />
			<h:form class="note-form" id="form">



				<div class="row">
					<div class="col-md-12">
						<div class="panel panel-success">
							
							
								<div class="panel-body">
									<div class="form-group has-success">
										
										<TABLE class="table">
											<tr>
												<td><h:outputLabel styleClass="grey" value="Type Congé : " /></td>
												<td>
													 <h:selectOneMenu
														class="form-control"
														value="#{congeService.conge.typeAbsence}"
														converter="#{typeAbsenceConverter}" id="type">
														
														<s:selectItems value="#{listeParamStock.listeLst_TypeAbsence}"
															var="var" label="#{var.libelle}" />


													</h:selectOneMenu>
														
											   </td>


											   <td><h:outputLabel styleClass="grey" value=" Motif : " /></td>
											    <td> 
												 <h:selectOneMenu
														class="form-control"
														value="#{congeService.conge.motifAbsence}"
														converter="#{motifAbsenceConverter}" id="motif">
														
														<s:selectItems value="#{listeParamStock.listeLst_MotifAbsence}" noSelectionLabel="Selectionnez..."
															var="var" label="#{var.libelle}" />


													</h:selectOneMenu>
													
												</td>
											</tr>

											<tr>
										    	<td><h:outputLabel styleClass="grey" value="Date Debut :" /></td>
												<td> 	
														<rich:calendar enableManualInput="true" valueChangeListener="#{congeService.renvoiDateFinDebut}"
														validatorMessage="X" maxlength="10"
														value="#{congeService.conge.dateDebut}"
														locale="fr" popup="#{true}" style="width:100px"
														datePattern="dd/MM/yyyy" required="false"
														requiredMessage="" cellWidth="1px" >
														
														<a:support event="onchange" reRender="idDateFin" ajaxSingle="true" />
														</rich:calendar>
												</td>
												<td><h:outputLabel styleClass="grey"
														value="Nombre de jours : " /></td>
											
														
											   <td>
												     <h:inputText 
														value="#{congeService.conge.nbrJours}"  valueChangeListener="#{congeService.renvoiDateFin}"  styleClass="margBot10px nbOnly "
														required="false" class="form-control" >
														 <a:support event="onchange" reRender="idDateFin" ajaxSingle="true" />
													</h:inputText>
												     
												</td>
												

											</tr>

											<tr>
												
												
												<td><h:outputLabel value="Date Fin : " 
														styleClass="grey" /></td>

												<td> 
														
												<rich:calendar enableManualInput="true" disabled="false" id="idDateFin"
														validatorMessage="X" maxlength="10"
														value="#{congeService.conge.dateFin}"
														locale="fr" popup="#{true}" style="width:100px"
														datePattern="dd/MM/yyyy" required="false"
														requiredMessage="" cellWidth="1px" /></td>
												
												
												
												<td><h:outputLabel styleClass="grey"
														value=" " /></td>
												<td> 
												</td>
											</tr>
											
											
											
																						
											
											
																					
											


										</TABLE>
										
										<p align="center">
										
										 <a:commandLink styleClass="btn btn-success"
																		 onclick="Richfaces.hideModalPanel('sim');"
																		value=""
																		action="#{congeService.save}"
																		reRender="conge" status="waitStatus" >
																		
																		Valider			
																				</a:commandLink>
																				
																		<rich:spacer width="10px"> </rich:spacer>
									   <a:commandLink styleClass="btn btn-danger"
																		 onclick="Richfaces.hideModalPanel('sim');"
																		value=""
																		action="#{congeService.annuler}"
																		reRender="conge" status="waitStatus" >
																		
																		Annuler			
																				</a:commandLink>
										
										
									
										</p>
									
									</div>

								</div>
							
						</div>
					</div>
				</div>


			</h:form>
		</rich:modalPanel>





	</ui:define>
</ui:composition>